// 외부 import 없음

function getMaxCellTextWidth(colId) {
  const ctx = getMaxCellTextWidth._ctx || (getMaxCellTextWidth._ctx = document.createElement('canvas').getContext('2d'));
  const nodes = document.querySelectorAll(
    `.ag-center-cols-container [col-id="${colId}"], .ag-left-cols-container [col-id="${colId}"], .ag-right-cols-container [col-id="${colId}"]`
  );
  let max = 0, fontSet = false;
  nodes.forEach(cell => {
    const el = cell.querySelector('.ag-cell-value') || cell;
    if (!fontSet) { ctx.font = getComputedStyle(el).font; fontSet = true; }
    const s = (el.textContent || '').trim();
    if (s) {
      const w = Math.ceil(ctx.measureText(s).width);
      if (w > max) max = w;
    }
  });
  return max; // px (패딩은 필요 시 호출부에서 +10~14 정도 더하세요)
}