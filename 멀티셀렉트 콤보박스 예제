<template>
  <div id="app">
    <h1>Vue2 Virtual Combo Sample</h1>

    <!-- 아이템 개수 제어 영역 -->
    <div class="control-panel">
      <label class="control-label">
        아이템 개수:
      </label>
      <input
        v-model.number="itemCountInput"
        type="number"
        min="0"
        class="control-input"
        @keyup.enter="applyItemCount"
      />
      <button
        type="button"
        class="control-button"
        @click="applyItemCount"
      >
        적용
      </button>
      <span class="control-hint">
        현재 아이템 수: {{ items.length }} 개
      </span>
    </div>

    <div class="demo-container">
      <div class="demo-block">
        <h2>멀티 셀렉트 (동적 아이템 수)</h2>
        <VirtualComboSelect
          v-model="selectedMulti"
          :items="items"
          :multiple="true"
          placeholder="장비를 선택하세요 (다중 선택)"
          search-placeholder="장비 ID / 이름 검색"
        />
        <p class="result-text">
          선택된 ID 배열: {{ selectedMulti }}
        </p>
      </div>

      <div class="demo-block">
        <h2>싱글 셀렉트 (동적 아이템 수)</h2>
        <VirtualComboSelect
          v-model="selectedSingle"
          :items="items"
          :multiple="false"
          placeholder="장비를 하나 선택하세요"
          search-placeholder="장비 ID / 이름 검색"
        />
        <p class="result-text">
          선택된 ID: {{ selectedSingle }}
        </p>
      </div>
    </div>
  </div>
</template>

<script>
import VirtualComboSelect from './components/VirtualComboSelect.vue'

export default {
  name: 'App',
  components: {
    VirtualComboSelect
  },
  data() {
    return {
      /**
       * 콤보박스에 표시할 아이템 배열
       *  - [{ id, label }, ...]
       */
      items: [],
      /**
       * 멀티 셀렉트 선택 값 (id 배열)
       */
      selectedMulti: [],
      /**
       * 싱글 셀렉트 선택 값 (단일 id)
       */
      selectedSingle: null,
      /**
       * 화면 상단 인풋에 바인딩되는 아이템 개수 입력 값
       */
      itemCountInput: 20000
    }
  },
  created() {
    /**
     * 초기 아이템 개수를 기준으로 items를 생성한다.
     */
    this.regenerateItems(this.itemCountInput)
  },
  methods: {
    /**
     * 상단 인풋/버튼에서 호출되어, 입력된 개수대로 items를 재생성한다.
     * @returns {void}
     */
    applyItemCount() {
      let nextCount = Number(this.itemCountInput)

      if (Number.isNaN(nextCount)) {
        nextCount = 0
      }

      if (nextCount < 0) {
        nextCount = 0
      }

      // 필요하면 상한을 두고 싶을 때 사용 (예: 100000)
      // const MAX_COUNT = 100000
      // if (nextCount > MAX_COUNT) {
      //   nextCount = MAX_COUNT
      // }

      this.itemCountInput = nextCount
      this.regenerateItems(nextCount)

      // 아이템 구성이 바뀌었으므로 선택 값도 함께 초기화
      this.selectedMulti = []
      this.selectedSingle = null
    },

    /**
     * 지정된 개수만큼 items 배열을 다시 생성한다.
     * @param {number} count : 생성할 아이템 개수
     * @returns {void}
     */
    regenerateItems(count) {
      const nextItems = []

      for (let index = 1; index <= count; index += 1) {
        const itemId = 'EQP_' + index
        const itemLabel = 'Eqp ' + index + ' (장비 ' + index + ')'

        nextItems.push({
          id: itemId,
          label: itemLabel
        })
      }

      this.items = nextItems
    }
  }
}
</script>

<style>
#app {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  margin: 20px;
}

/* 상단 제어 패널 */
.control-panel {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 24px;
}

.control-label {
  font-size: 13px;
}

.control-input {
  width: 120px;
  padding: 4px 6px;
  font-size: 13px;
  border: 1px solid #bdbdbd;
  border-radius: 2px;
}

.control-button {
  padding: 4px 10px;
  font-size: 13px;
  border-radius: 2px;
  border: 1px solid #444444;
  background-color: #ffffff;
  cursor: pointer;
}

.control-button:hover {
  background-color: #f5f5f5;
}

.control-hint {
  font-size: 12px;
  color: #666666;
}

/* 데모 레이아웃 */
.demo-container {
  display: flex;
  gap: 40px;
  flex-wrap: wrap;
}

.demo-block {
  min-width: 320px;
}

h1 {
  margin-bottom: 12px;
}

h2 {
  margin: 0 0 8px;
}

.result-text {
  font-size: 12px;
  margin-top: 8px;
  color: #555555;
  word-break: break-all;
}
</style>